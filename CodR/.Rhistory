wOptim
w <- Variable(N)
r <- quad_form(w, cov)
objective <- Minimize(r)
constraints <- list(w >= 0, sum(w) == 1)
problem <- Problem(objective, constraints)
result <- solve(problem)
wOptim2 <- result$getValue(w)
wOptim
wOptim2
estSample <- function(data,i,j,...){
meanSample <- apply(data[i:j,], 2, mean)
matrixCovSample <- cov(data[i:j,])
return(list(mean = meanSample, matrixCov = matrixCovSample))
}
estGAS <- function(specf, data, i, j, nWin, ...){
fit <- MultiGASFit(GASSpec = specf, data = data[i:j,])
meanGAS <- fit@Estimates$Moments$mean[nWin,]
matrixCovGAS <- fit@Estimates$Moments$cov[,,nWin]
return(list(mean = meanGAS, matrixCov = matrixCovGAS))
}
optimWCRRA <- function(N, mean, cov, v, ...){
library(CVXR)
w <- Variable(N)
r <- quad_form(w, cov)
objective <- Maximize( ( 1/(1-v) ) +
(t(w)%*%mean) - (v * ( (r) + (t(w)%*%mean)^2 )/2) )
constraints <- list(w >= 0, sum(w) == 1)
problem <- Problem(objective, constraints)
result <- solve(problem)
wOptim <- result$getValue(w)
return(wOptim)
}
optimWMeanVar <- function(N, mean, cov, v, ...){
library(CVXR)
w <- Variable(N)
r <- quad_form(w, cov)
objective <- Minimize( r - ((1/v) * t(mean)%*%w))
constraints <- list(w >= 0, sum(w) == 1)
problem <- Problem(objective, constraints)
result <- solve(problem)
wOptim <- result$getValue(w)
return(wOptim)
}
optimWMinVar <- function(N, mean, cov, v, ...){
library(CVXR)
w <- Variable(N)
r <- quad_form(w, cov)
objective <- Minimize(r)
constraints <- list(w >= 0, sum(w) == 1)
problem <- Problem(objective, constraints)
result <- solve(problem)
wOptim <- result$getValue(w)
return(wOptim)
}
returnP <- function(wOptim, data, j, ....){
rp <- sum(wOptim*data[j+1,])
return(rp)
}
window <- 200
v <- 5
# 6 portfolio ----------------
data <- read.csv('data6.csv', header = T, na.strings = "NA")
data$date <- as.Date(paste0(as.character(data$date), '01'), format='%Y%m%d')
data <- data[data$date >= "1998-01-01" &  data$date <="2019-12-01", -1]
N <- ncol(data)
returnPortSample6CRRA <- vector()
returnPortSample6MeanVar <- vector()
returnPortSample6MinVar <- vector()
for (i in 1:(nrow(data) - window)) {
i = i
j = i + window
est <- estSample(data = data, i = i, j = j)
mean <- est[[1]]
cov <- est[[2]]
returnPortSample6CRRA <- c(returnPortSample6CRRA,
returnP(wOptim = optimWCRRA(N = N,
mean = mean,
cov = cov, v = v),
data = data, j = j))
returnPortSample6MeanVar <- c(returnPortSample6MeanVar,
returnP(wOptim = optimWMeanVar(N = N,
mean = mean,
cov = cov,
v = v),
data = data, j = j))
returnPortSample6MinVar <- c(returnPortSample6MinVar,
returnP(wOptim = optimWMinVar(N = N,
mean = mean,
cov = cov,
v = v),
data = data, j = j))
}
data <- read.csv('data25.csv', header = T, na.strings = "NA")
data$date <- as.Date(paste0(as.character(data$date), '01'), format='%Y%m%d')
data <- data[data$date >= "2000-01-01" &  data$date <="2019-12-01", -1]
returnPortSample25CRRA <- vector()
returnPortSample25MeanVar <- vector()
returnPortSample25MinVar <- vector()
for (i in 1:(nrow(data) - window)) {
i = i
j = i + window
est <- estSample(data = data, i = i, j = j)
mean <- est[[1]]
cov <- est[[2]]
returnPortSample25CRRA <- c(returnPortSample25CRRA,
returnP(wOptim = optimWCRRA(N = N,
mean = mean,
cov = cov, v = v),
data = data, j = j))
returnPortSample25MeanVar <- c(returnPortSample25MeanVar,
returnP(wOptim = optimWMeanVar(N = N,
mean = mean,
cov = cov,
v = v),
data = data, j = j))
returnPortSample25MinVar <- c(returnPortSample25MinVar,
returnP(wOptim = optimWMinVar(N = N,
mean = mean,
cov = cov,
v = v),
data = data, j = j))
}
data <- read.csv('data25.csv', header = T, na.strings = "NA")
data$date <- as.Date(paste0(as.character(data$date), '01'), format='%Y%m%d')
data <- data[data$date >= "2000-01-01" &  data$date <="2019-12-01", -1]
class(data[,1])
data <- read.csv('data25.csv', header = T, na.strings = "NA")
data$date <- as.Date(paste0(as.character(data$date), '01'), format='%Y%m%d')
data <- data[data$date >= "2000-01-01" &  data$date <="2019-12-01", -1]
N <- ncol(data)
returnPortSample25CRRA <- vector()
returnPortSample25MeanVar <- vector()
returnPortSample25MinVar <- vector()
for (i in 1:(nrow(data) - window)) {
i = i
j = i + window
est <- estSample(data = data, i = i, j = j)
mean <- est[[1]]
cov <- est[[2]]
returnPortSample25CRRA <- c(returnPortSample25CRRA,
returnP(wOptim = optimWCRRA(N = N,
mean = mean,
cov = cov, v = v),
data = data, j = j))
returnPortSample25MeanVar <- c(returnPortSample25MeanVar,
returnP(wOptim = optimWMeanVar(N = N,
mean = mean,
cov = cov,
v = v),
data = data, j = j))
returnPortSample25MinVar <- c(returnPortSample25MinVar,
returnP(wOptim = optimWMinVar(N = N,
mean = mean,
cov = cov,
v = v),
data = data, j = j))
}
data <- read.csv('data100.csv', header = T, na.strings = "NA")
data$date <- as.Date(paste0(as.character(data$date), '01'), format='%Y%m%d')
data <- data[data$date >= "2000-01-01" &  data$date <="2019-12-01", -1]
N <- ncol(data)
returnPortSample100CRRA <- vector()
returnPortSample100MeanVar <- vector()
returnPortSample100MinVar <- vector()
for (i in 1:(nrow(data) - window)) {
i = i
j = i + window
est <- estSample(data = data, i = i, j = j)
mean <- est[[1]]
cov <- est[[2]]
returnPortSample100CRRA <- c(returnPortSample100CRRA,
returnP(wOptim = optimWCRRA(N = N,
mean = mean,
cov = cov, v = v),
data = data, j = j))
returnPortSample100MeanVar <- c(returnPortSample100MeanVar,
returnP(wOptim = optimWMeanVar(N = N,
mean = mean,
cov = cov,
v = v),
data = data, j = j))
returnPortSample100MinVar <- c(returnPortSample100MinVar,
returnP(wOptim = optimWMinVar(N = N,
mean = mean,
cov = cov,
v = v),
data = data, j = j))
}
system("xdg-open 'https://www.youtube.com/watch?v=TOamHghGCfg'")
#100 portfolio -------------------------
data <- read.csv('data100.csv', header = T, na.strings = "NA")
data$date <- as.Date(paste0(as.character(data$date), '01'), format='%Y%m%d')
data <- data[data$date >= "2000-01-01" &  data$date <="2019-12-01", -1]
N <- ncol(data)
apply(data, 2, class)
data <- apply(data, 2, as.numeric)
View(data)
which(is.na(data))
data[,which(is.na(data))]
is.na(data)
sum(is.na(data))
which(is.na.data.frame(data))
data[,165]
data[165,]
data[165,67]
data[238,67]
is.na(data[165,67])
apply(data,1,which(is.na()))
apply(data,1,which(is.na(data)))
na <- function(x){return(which(is.na(x)))}
apply(data,1,na)
nas <- apply(data,1,na) != 0
nas <- apply(data,1,na)
which(nas != 0)
View(nas)
data[,100]
sum(is.na(data[,100]))
sum(is.na(data[,70]))
rm(na)
rm(nas)
rm(cov)
rm(est)
rm(i)
rm(j)
rm(N)
rm(mean)
window <- 200
data <- read.csv('data6.csv', header = T, na.strings = "NA")
data$date <- as.Date(paste0(as.character(data$date), '01'), format='%Y%m%d')
data <- data[data$date >= "1998-01-01" &  data$date <="2019-12-01", -1]
N <- ncol(data)
returnPortEW6 <- vector()
for (i in 1:(nrow(data) - window)) {
i = i
j = i + window
returnPortEW6 <- c(returnPortEW, sum(data[j+1,])/N)
}
data <- read.csv('data6.csv', header = T, na.strings = "NA")
data$date <- as.Date(paste0(as.character(data$date), '01'), format='%Y%m%d')
data <- data[data$date >= "1998-01-01" &  data$date <="2019-12-01", -1]
N <- ncol(data)
returnPortEW6 <- vector()
for (i in 1:(nrow(data) - window)) {
i = i
j = i + window
returnPortEW6 <- c(returnPortEW6, sum(data[j+1,])/N)
}
#25 portfolio ---------------------------------
data <- read.csv('data25.csv', header = T, na.strings = "NA")
data$date <- as.Date(paste0(as.character(data$date), '01'), format='%Y%m%d')
data <- data[data$date >= "1998-01-01" &  data$date <="2019-12-01", -1]
N <- ncol(data)
returnPortEW25 <- vector()
for (i in 1:(nrow(data) - window)) {
i = i
j = i + window
returnPortEW25 <- c(returnPortEW25, sum(data[j+1,])/N)
}
rm(i)
rm(j)
rm(N)
rm(returnPortSample100CRRA)
rm(returnPortSample100MeanVar)
rm(returnPortSample100MinVar)
rm(returnPortSample25CRRA)
rm(returnPortSample25MeanVar)
rm(returnPortSample25MinVar)
data <- read.csv('data25.csv', header = T, na.strings = "NA")
data$date <- as.Date(paste0(as.character(data$date), '01'), format='%Y%m%d')
data <- data[data$date >= "2000-01-01" &  data$date <="2019-12-01", -1]
N <- ncol(data)
returnPortSample25CRRA <- vector()
returnPortSample25MeanVar <- vector()
returnPortSample25MinVar <- vector()
for (i in 1:(nrow(data) - window)) {
i = i
j = i + window
est <- estSample(data = data, i = i, j = j)
mean <- est[[1]]
cov <- est[[2]]
returnPortSample25CRRA <- c(returnPortSample25CRRA,
returnP(wOptim = optimWCRRA(N = N,
mean = mean,
cov = cov, v = v),
data = data, j = j))
returnPortSample25MeanVar <- c(returnPortSample25MeanVar,
returnP(wOptim = optimWMeanVar(N = N,
mean = mean,
cov = cov,
v = v),
data = data, j = j))
returnPortSample25MinVar <- c(returnPortSample25MinVar,
returnP(wOptim = optimWMinVar(N = N,
mean = mean,
cov = cov,
v = v),
data = data, j = j))
}
1:(nrow(data) - window)
1:(nrow(data) - window)
(nrow(data) - window)
data <- read.csv('data25.csv', header = T, na.strings = "NA")
data$date <- as.Date(paste0(as.character(data$date), '01'), format='%Y%m%d')
data <- data[data$date >= "1998-01-01" &  data$date <="2019-12-01", -1]
N <- ncol(data)
returnPortSample25CRRA <- vector()
returnPortSample25MeanVar <- vector()
returnPortSample25MinVar <- vector()
for (i in 1:(nrow(data) - window)) {
i = i
j = i + window
est <- estSample(data = data, i = i, j = j)
mean <- est[[1]]
cov <- est[[2]]
returnPortSample25CRRA <- c(returnPortSample25CRRA,
returnP(wOptim = optimWCRRA(N = N,
mean = mean,
cov = cov, v = v),
data = data, j = j))
returnPortSample25MeanVar <- c(returnPortSample25MeanVar,
returnP(wOptim = optimWMeanVar(N = N,
mean = mean,
cov = cov,
v = v),
data = data, j = j))
returnPortSample25MinVar <- c(returnPortSample25MinVar,
returnP(wOptim = optimWMinVar(N = N,
mean = mean,
cov = cov,
v = v),
data = data, j = j))
}
rm(cov)
rm(data)
rm(est)
rm(i)
rm(j)
rm(mean)
rm(N)
library(GAS)
window <- 200
v <- 5
specf <- MultiGASSpec(Dist = "mvt")
data <- read.csv('data6.csv', header = T, na.strings = "NA")
data$date <- as.Date(paste0(as.character(data$date), '01'), format='%Y%m%d')
data <- data[data$date >= "1998-01-01" &  data$date <="2019-12-01", -1]
N <- ncol(data)
returnPortGASt6CRRA <- vector()
returnPortGASt6MeanVar <- vector()
returnPortGASt6MinVar <- vector()
for (i in 1:(nrow(data) - window)) {
i = i
j = i + window
est <- estGAS(specf = specf, data = data, i = i,
j = j, nWin = window)
mean <- est[[1]]
cov <- est[[2]]
returnPortGASt6CRRA <- c(returnPortGASt6CRRA,
returnP(wOptim = optimWCRRA(N = N,
mean = mean,
cov = cov, v = v),
data = data, j = j))
returnPortGASt6MeanVar <- c(returnPortGASt6MeanVar,
returnP(wOptim = optimWMeanVar(N = N,
mean = mean,
cov = cov,
v = v),
data = data, j = j))
returnPortGASt6MinVar <- c(returnPortGASt6MinVar,
returnP(wOptim = optimWMinVar(N = N,
mean = mean,
cov = cov,
v = v),
data = data, j = j))
}
sum(is.na(data))
est <- estGAS(specf = specf, data = data, i = i,
j = j, nWin = window)
data[237,]
data[236,]
data[235,]
data
data[235,]
data[236,]
data[237,]
data[238,]
data[239,]
i=38
j=238
est <- estGAS(specf = specf, data = data, i = i,
j = j, nWin = window)
returnPortGASt100MinVar
returnPortGASt100MinVar
returnPortGASt6MinVar
returnPortGASt6MinVar[37] <- NA
returnPortGASt6MeanVar[37] <- NA
returnPortGASt6CRRA[37] <- NA
for (i in 38:(nrow(data) - window)) {
i = i
j = i + window
est <- estGAS(specf = specf, data = data, i = i,
j = j, nWin = window)
mean <- est[[1]]
cov <- est[[2]]
returnPortGASt6CRRA <- c(returnPortGASt6CRRA,
returnP(wOptim = optimWCRRA(N = N,
mean = mean,
cov = cov, v = v),
data = data, j = j))
returnPortGASt6MeanVar <- c(returnPortGASt6MeanVar,
returnP(wOptim = optimWMeanVar(N = N,
mean = mean,
cov = cov,
v = v),
data = data, j = j))
returnPortGASt6MinVar <- c(returnPortGASt6MinVar,
returnP(wOptim = optimWMinVar(N = N,
mean = mean,
cov = cov,
v = v),
data = data, j = j))
}
window <- 200
v <- 5
specf <- MultiGASSpec()
# 6 portfolio ----------------
data <- read.csv('data6.csv', header = T, na.strings = "NA")
data$date <- as.Date(paste0(as.character(data$date), '01'), format='%Y%m%d')
data <- data[data$date >= "1998-01-01" &  data$date <="2019-12-01", -1]
N <- ncol(data)
returnPortGASnormal6CRRA <- vector()
returnPortGASnormal6MeanVar <- vector()
returnPortGASnormal6MinVar <- vector()
for (i in 1:(nrow(data) - window)) {
i = i
j = i + window
est <- estGAS(specf = specf, data = data, i = i,
j = j, nWin = window)
mean <- est[[1]]
cov <- est[[2]]
returnPortGASnormal6CRRA <- c(returnPortGASnormal6CRRA,
returnP(wOptim = optimWCRRA(N = N,
mean = mean,
cov = cov, v = v),
data = data, j = j))
returnPortGASnormal6MeanVar <- c(returnPortGASnormal6MeanVar,
returnP(wOptim = optimWMeanVar(N = N,
mean = mean,
cov = cov,
v = v),
data = data, j = j))
returnPortGASnormal6MinVar <- c(returnPortGASnormal6MinVar,
returnP(wOptim = optimWMinVar(N = N,
mean = mean,
cov = cov,
v = v),
data = data, j = j))
}
returnPortGASnormal6CRRA
returnPortGASnormal6MeanVar
returnPortGASnormal6MinVar
returnPortGASt6CRRA
metrics <- function(x){
meanR <- mean(x)*sqrt(12)
sdR <- sd(x)*sqrt(12)
SR <- meanR/sdR
return(meanR, sdR, SR)
}
?mean
?sd
#função -------------
metrics <- function(x){
meanR <- mean(x, na.rm = T)*sqrt(12)
sdR <- sd(x, na.rm = T)*sqrt(12)
SR <- meanR/sdR
return(meanR, sdR, SR)
}
dataPort6 <- data.frame(returnPortEW6, returnPortGASnormal6CRRA,
returnPortGASnormal6MeanVar,
returnPortGASnormal6MinVar,
returnPortGASt6CRRA, returnPortGASt6MeanVar,
returnPortGASt6MinVar, returnPortSample6CRRA,
returnPortSample6MeanVar, returnPortSample6MinVar)
apply(dataPort6, 2, metrics)
#função -------------
metrics <- function(x){
meanR <- mean(x, na.rm = T)*sqrt(12)
sdR <- sd(x, na.rm = T)*sqrt(12)
SR <- meanR/sdR
return(list(meanR, sdR, SR))
}
apply(dataPort6, 2, metrics)
#função -------------
metrics <- function(x){
meanR <- mean(x, na.rm = T)*sqrt(12)
sdR <- sd(x, na.rm = T)*sqrt(12)
SR <- meanR/sdR
return(list(meanR = meanR, sdR = sdR, SR = SR))
}
apply(dataPort6, 2, metrics)
table(apply(dataPort6, 2, metrics))
unlist(apply(dataPort6, 2, metrics))
table(unlist(apply(dataPort6, 2, metrics)))
metricsPort6 <- unlist(apply(dataPort6, 2, metrics))
metricsPort6 <- as.data.frame(unlist(apply(dataPort6, 2, metrics)))
View(metricsPort6)
metricsPort6 <- t(as.data.frame(unlist(apply(dataPort6, 2, metrics))))
View(metricsPort6)
write.csv(metricsPort6, file = "metricsPort6")
write.csv(dataPort6, file = "dataPort6")
save.image()
